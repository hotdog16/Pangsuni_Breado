{% extends 'layout.html' %} {% block body %}
<div id="join">
  <h2>회원가입</h2>
  <form action="/join" method="post" id="join">
    <div class="join-input">
      <label>이름</label>
      <input type="text" name="u_name" class="name" />

      <label>아이디</label>
      <input type="text" name="u_id" class="id" />
      <button class="id-chk-btn" type="button">중복 체크</button>
      <span class="id_chk_btn"></span>

      <label>비밀번호</label>
      <input type="password" name="u_pwd" class="password" />

      <label>비밀번호확인</label>
      <input type="password" class="re-password" />

      <label>전화번호</label>
      <input type="text" name="u_tel" class="tel" />

      <label>이메일</label>
      <input type="email" name="u_email" class="email" />
    </div>
    <button class="btn join-btn" type="submit">회원가입</button>
  </form>
</div>

{% endblock %} {% block script %}
<script type="text/javascript" src="https://unpkg.com/axios@0.26.0/dist/axios.min.js"></script>
<script>
  let userName = document.querySelector(".name").value;
  let userId = document.querySelector(".id").value;
  let userPassword = document.querySelector(".password").value;
  let rePassword = document.querySelector(".re-password").value;
  let userTel = document.querySelector(".tel").value;
  let userEmail = document.querySelector(".email").value;
  let joinBtn = document.querySelector(".join-btn");

  let idChkBtn = document.querySelector(".id-chk-btn");

  joinBtn.addEventListener("click", function () {
    if (userName == "" || userId == "" || userPassword == "" || rePassword == "" || userTel == "" || userEmail == "") {
      alert("빈칸이 있습니다, 모두 입력한 후 회원가입이 가능합니다");
    }
  });

  idChkBtn.addEventListener("click", function () {
    if (userId == "") {
      alert("아이디를 입력해주세요");
    }
  });

  async function userid_check() {
    let data = await axios.get(`http://localhost:3002/join${u_id.value}`);
    //AJAX id 값 가져와서 중복 아니면 true, 중복이면 false

    console.log(data);

    login_flag = data.data.login;
    if (login_flag) {
      userid_msg.innerHTML = "사용 가능한 아이디 입니다.";
      userid_msg.style.color = "green";
    } else {
      userid_msg.innerHTML = "중복된 아이디 입니다.";
      userid_msg.style.color = "red";
    }
  }

  userid.addEventListener("focusout", userid_check); // 커서가 밖으로 갔을 때 저 함수를 실행시켜라
</script>
{% endblock %}
