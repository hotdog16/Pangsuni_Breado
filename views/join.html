{% extends 'layout.html' %} {% block body %}

<div id="join">
  <h2>회원가입</h2>
  <form action="/join" method="post">
    <div class="join-input">
      <label>이름</label>
      <input type="text" name="u_name" class="name" />

      <label>아이디</label>
      <input type="text" name="u_id" class="id" />
      <div class="idCheck">중복체크</div>
      <span class="check_id"></span>

      <label>비밀번호</label>
      <input type="password" name="u_pwd" class="password" />

      <label>비밀번호확인</label>
      <input type="password" class="re-password" />

      <label>전화번호</label>
      <input type="text" name="u_tel" class="tel" />

      <label>이메일</label>
      <input type="email" name="u_email" class="email" />
    </div>
    <button class="btn join-btn" type="submit">회원가입</button>
  </form>
</div>
<script type="text/javascript">
  const id = $(".id").val();
  $(document).ready(function () {
    $(".idCheck").click(function () {
      axios({
        url: "/idCheck", // 통신할 웹문서
        method: "post", // 통신할 방식
        data: {
          // 인자로 보낼 데이터
          id: id,
        },
        responseType: "json",
        responseEncoding: "utf-8",
      })
        .then((res) => {
          console.log("axios1->", res);
          console.log("axios2->", res.data.msg);
          console.log("axios3->", res.status);
          if (res.response.status == 200) {
            $(".check_id").text(`사용가능한 아이디 입니다.`);
          }
        })
        .catch((error) => {
          console.log("555555->", error.response.status);
          if (error.response.status == 300) {
            $(".check_id").text(`이미 존재하는 아이디 입니다.`);
          }
        });
    });
    //id 중복체크
  });
</script>
{% endblock %} {% block script %} {% endblock %}
