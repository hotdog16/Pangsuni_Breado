{% extends 'layout.html' %}
{% block body %}


<div id="store">
    <h4>지역선택</h4>
<ul class="region-list">
    
{% for region in regions %}
<li class="region" data-id="{{region.r_no}}">{{region.r_name}}</li>
{% endfor %}
</ul>

<div id="regionStore">
    <h1>지역가게리스트</h1>
</div>
</div>
<!--<div id="map" style="width:400px;height:350px;"></div>-->
{% endblock %}
{% block script %}
<!--<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey={{mapAPI}}&libraries=services"></script>-->
<!--<script>-->
<!--    const mapContainer = document.getElementById('map'); // 지도를 표시할 div-->
<!--    const mapOption = {-->
<!--        center: new kakao.maps.LatLng(35.861292438004945, 128.5562526030231), // 지도의 중심좌표-->
<!--        level: 3 // 지도의 확대 레벨-->
<!--    };-->
<!--    // function testing(keyword){-->
<!--    // 지도를 생성합니다-->
<!--    const map = new kakao.maps.Map(mapContainer, mapOption);-->
<!--    // 주소-좌표 변환 객체를 생성합니다-->
<!--    const geocoder = new kakao.maps.services.Geocoder();-->

<!--    // 주소로 좌표를 검색합니다-->
<!--    function search(target) {-->
<!--        geocoder.addressSearch(target, function (result, status) {-->
<!--            // 정상적으로 검색이 완료됐으면-->
<!--            if (status === kakao.maps.services.Status.OK) {-->
<!--                const coords = new kakao.maps.LatLng(result[0].y, result[0].x);-->
<!--                // 결과값으로 받은 위치를 마커로 표시합니다-->
<!--                const marker = new kakao.maps.Marker({-->
<!--                    map: map,-->
<!--                    position: coords-->
<!--                });-->
<!--                // 인포윈도우로 장소에 대한 설명을 표시합니다-->
<!--                const infowindow = new kakao.maps.InfoWindow({-->
<!--                    content: '<div style="width:150px;text-align:center;padding:6px 0;">빠다롤프랑</div>'-->
<!--                });-->
<!--                infowindow.open(map, marker);-->
<!--                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다-->
<!--                map.setCenter(coords);-->
<!--            }-->
<!--        });-->
<!--    }-->
<!--</script>-->
<script>
    const regions = document.querySelectorAll('.region');
    const regionStore = document.querySelector('#regionStore');
    regions.forEach((region) => {
        region.addEventListener('click', function () {
            const r_no = this.dataset.id;
            try {
                axios.post(`/store`, {r_no: r_no})
                    .then((result) => {
                        regionStore.innerHTML = '';
                        for (let item of result.data.stores) {
                            const store = document.createElement('div');
                            store.innerHTML = `<div class="store">
                                                    <a href="/store/detail/${item.s_no}">
                                                    <p><img src="${item.s_img}" alt="${item.s_name}의 이미지"></p>
                                                    <p>${item.s_name}</p><p>${item.s_desc}</p>
                                                    <p>${item.s_addr}</p><p>${item.s_tel}</p>
                                                    </a>
                                                </div>`;
                            regionStore.append(store);
                        }
                        ;
                    });
            } catch (e) {
                console.error(e);
            }
        })
    })
</script>
{% endblock %}